#!/usr/bin/env node

var path = require('path')
  , husk = require('..').core().exec().fs()
  .plugin([
    require('husk-pluck'),
    require('husk-transform'),
  ]);

var name = path.basename(__filename) + '-example.log'
  , content = '[file content]'
  , info = {};

husk(name)
  .through(function(){info.file = this.valueOf()})
  .open('w')
  .pluck(1)
  .through(function(){info.fd = this.valueOf()})
  .async(function write(cb) {
    var fd = this.valueOf();
    var h = husk(fd)
      .fdwrite(fd, content)
      .close(fd)
      .run(cb);
  })
  //.cat(name)
  .unlink(name)
  .through(function(){info.unlink = this[0] === null})
  .run(function() {
    console.dir(info);
  });
