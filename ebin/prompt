#!/usr/bin/env node

var husk = require('..').exec()
  .plugin([
    // force terminal for sbin/ebin execution
    {plugin: require('husk-prompt'), conf: {terminal: true}},
    require('husk-wait')
  ]);

husk('lib')
  // auto fill prompt so it can be automated
  .wait('prompt âš¡ choose directory: (lib)', function() {
    function send() {
      process.stdin.emit('keypress', 'doc\r\n');
    }
    setTimeout(send, 10);
  })
  .prompt({terminal: true}, function(ps, chunk, encoding, cb) {
    ps.prompt(
      {
        message: 'choose directory:',
        default: 'lib',
        required: true,
        repeat: true
      },
      function complete(err, val) {
        ps.close();
        cb(err, val ? val[0] : null);
      })
  })
  .find(function(){return [this.valueOf()]})
  .print()
  .run();
